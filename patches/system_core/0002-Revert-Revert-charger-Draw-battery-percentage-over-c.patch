From 85008bd0194386f12c2db0e618bf995cef81e03f Mon Sep 17 00:00:00 2001
From: Rammar515 <rammarad515@gmail.com>
Date: Mon, 27 Oct 2014 12:18:13 +0100
Subject: [PATCH] Revert "Revert "charger: Draw battery percentage over charger
 screen""

This reverts commit 54e72ea75e31eecee0589909e2bfe733b355baa8.
---
 charger/charger.c | 18 +++++++++++++++++-
 1 file changed, 17 insertions(+), 1 deletion(-)

diff --git a/charger/charger.c b/charger/charger.c
index e8c3183..95a1316 100644
--- a/charger/charger.c
+++ b/charger/charger.c
@@ -707,6 +707,20 @@ static void android_blue(void)
     gr_color(0, 191, 255, 255);
 }
 
+static void draw_capacity(struct charger *charger)
+{
+    char cap_str[64];
+    int x, y;
+    int str_len_px;
+
+    snprintf(cap_str, sizeof(cap_str), "%d%%", charger->batt_anim->capacity);
+    str_len_px = gr_measure(cap_str);
+    x = (gr_fb_width() - str_len_px) / 2;
+    y = (gr_fb_height() + char_height) / 2;
+    android_blue();
+    gr_text(x, y, cap_str, 0);
+}
+
 /* returns the last y-offset of where the surface ends */
 static int draw_surface_centered(struct charger *charger, gr_surface surface)
 {
@@ -759,8 +773,10 @@ static void redraw_screen(struct charger *charger)
     /* try to display *something* */
     if (batt_anim->capacity < 0 || batt_anim->num_frames == 0)
         draw_unknown(charger);
-    else
+    else {
         draw_battery(charger);
+        draw_capacity(charger);
+    }
     gr_flip();
 }
 
-- 
1.9.1
